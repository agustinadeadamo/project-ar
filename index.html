<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Touch Gestures</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <link type="text/css" rel="stylesheet" href="style.css" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <script type="module">
      import { ARButton } from "https://unpkg.com/three@0.126.0/examples/jsm/webxr/ARButton.js";

      let camera, scene, renderer;
      let controller;
      let mesh;
      let textFirstleaf;

      init();
      animate();

      function insertBottle() {
        const color = 0xffffff * Math.random();

        const geoCilinderBottle3 = new THREE.CylinderGeometry(
          0.1,
          0.1,
          0.5,
          32
        );
        const materialgeoCilinderBottle3 = new THREE.MeshBasicMaterial({
          color: color,
        });
        const cilinderBottle3 = new THREE.Mesh(
          geoCilinderBottle3,
          materialgeoCilinderBottle3
        );
        cilinderBottle3.position
          .set(0, 0, -1)
          .applyMatrix4(controller.matrixWorld);
        cilinderBottle3.quaternion.setFromRotationMatrix(
          controller.matrixWorld
        );
        cilinderBottle3.castShadow = true;
        scene.add(cilinderBottle3);

        // CONO BOTTLE 3
        const geoConoBottle3 = new THREE.ConeGeometry(0.1, 0.08, 32);
        const materialgeoConoBottle3 = new THREE.MeshBasicMaterial({
          color: color,
        });
        const conoBottle3 = new THREE.Mesh(
          geoConoBottle3,
          materialgeoConoBottle3
        );
        conoBottle3.position
          .set(0, 0.29, -1)
          .applyMatrix4(controller.matrixWorld);
        conoBottle3.quaternion.setFromRotationMatrix(controller.matrixWorld);
        scene.add(conoBottle3);

        // LID BOTTLE 3
        const geoLidBottle3 = new THREE.CylinderGeometry(0.03, 0.03, 0.15, 32);
        const materialgeoLidBottle3 = new THREE.MeshBasicMaterial({
          color: color,
        });
        const LidBottle3 = new THREE.Mesh(geoLidBottle3, materialgeoLidBottle3);
        LidBottle3.position
          .set(0, 0.35, -1)
          .applyMatrix4(controller.matrixWorld);
        LidBottle3.quaternion.setFromRotationMatrix(controller.matrixWorld);
        scene.add(LidBottle3);
      }

      function init() {
        const container = document.createElement("div");
        document.body.appendChild(container);

        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera(
          70,
          window.innerWidth / window.innerHeight,
          0.01,
          40
        );

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.xr.enabled = true;
        container.appendChild(renderer.domElement);

        var light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1);
        light.position.set(0.5, 1, 0.25);
        scene.add(light);

        controller = renderer.xr.getController(0);
        controller.addEventListener("select", onSelect);
        scene.add(controller);

        document.body.appendChild(ARButton.createButton(renderer));

        window.addEventListener("resize", onWindowResize, false);
      }

      const loader = new THREE.FontLoader();

      function onSelect() {
        let funcs = [];
        funcs[0] = function inserText() {
          loader.load("Roboto_Medium.json", function (font) {
            // SPARKLING TEXT
            textFirstleaf = new THREE.TextGeometry("Firstleaf", {
              font: font,
              size: 0.04,
              height: 0.04,
            });

            const textSparklingMesh = new THREE.Mesh(textFirstleaf, [
              new THREE.MeshPhongMaterial({ color: 0xad4000 }),
              new THREE.MeshPhongMaterial({ color: 0x5c2301 }),
            ]);

            textSparklingMesh.castShadown = true;
            textSparklingMesh.position.z = -0.3;
            textSparklingMesh.position.x = 0;
            textSparklingMesh.position.y = 0;

            textSparklingMesh.position
              .set(0, 0, -0.3)
              .applyMatrix4(controller.matrixWorld);

            textSparklingMesh.quaternion.setFromRotationMatrix(
              controller.matrixWorld
            );
            textSparklingMesh.castShadow = true;

            scene.add(textSparklingMesh);
          });
        };

        funcs[1] = function insertBottle() {
          const color = 0xffffff * Math.random();

          const geoCilinderBottle3 = new THREE.CylinderGeometry(
            0.1,
            0.1,
            0.5,
            32
          );
          const materialgeoCilinderBottle3 = new THREE.MeshBasicMaterial({
            color: color,
          });
          const cilinderBottle3 = new THREE.Mesh(
            geoCilinderBottle3,
            materialgeoCilinderBottle3
          );
          cilinderBottle3.position
            .set(0, 0, -0.7)
            .applyMatrix4(controller.matrixWorld);
          cilinderBottle3.quaternion.setFromRotationMatrix(
            controller.matrixWorld
          );
          cilinderBottle3.castShadow = true;
          scene.add(cilinderBottle3);

          // CONO BOTTLE 3
          const geoConoBottle3 = new THREE.ConeGeometry(0.1, 0.08, 32);
          const materialgeoConoBottle3 = new THREE.MeshBasicMaterial({
            color: color,
          });
          const conoBottle3 = new THREE.Mesh(
            geoConoBottle3,
            materialgeoConoBottle3
          );
          conoBottle3.position
            .set(0, 0.29, -0.7)
            .applyMatrix4(controller.matrixWorld);
          conoBottle3.quaternion.setFromRotationMatrix(controller.matrixWorld);
          scene.add(conoBottle3);

          // LID BOTTLE 3
          const geoLidBottle3 = new THREE.CylinderGeometry(
            0.03,
            0.03,
            0.15,
            32
          );
          const materialgeoLidBottle3 = new THREE.MeshBasicMaterial({
            color: color,
          });
          const LidBottle3 = new THREE.Mesh(
            geoLidBottle3,
            materialgeoLidBottle3
          );
          LidBottle3.position
            .set(0, 0.35, -0.7)
            .applyMatrix4(controller.matrixWorld);
          LidBottle3.quaternion.setFromRotationMatrix(controller.matrixWorld);
          scene.add(LidBottle3);
        };

        var rand = parseInt(Math.random() * funcs.length);
        funcs[rand]();
      }

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize(window.innerWidth, window.innerHeight);
      }

      function animate() {
        renderer.setAnimationLoop(render);
      }

      function render() {
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
